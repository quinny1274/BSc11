<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="/js/bootstrap.min.js"></script>

</head>
<body class="pt-0 px-0">

<nav class="navbar navbar-expand-lg navbar-light bg-custom-primary sticky-top">
    <div class="container">
        <a class="navbar-brand text-light" href="/explore">PlantPedia</a>
        <div class="navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link text-light-custom btn btn-outline-secondary" href="/create">+ Add Plant</a>
                </li>
            </ul>
        </div>

        <div class="dropdown px-2">
            <button onclick="myFunction()" class="btn btn-outline-secondary text-light-custom dropbtn">
                Filter
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-filter dropbtn" viewBox="0 0 16 16">
                    <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5"/>
                </svg>
            </button>
            <div id="myDropdown" class="dropdown-content">
                <a href="/explore/sort/date_time">Date/Time</a>
                <a href="/explore/sort/identification">Identification Status</a>
                <a href="/explore/sort/location">Location</a>
            </div>
        </div>
    </div>
</nav>

<div class="row row-cols-1 row-cols-md-3 g-4 pt-4 px-5">
    <% data.forEach(plant => { %>
        <div class="col">
            <a href="/plants/<%= plant._id %>">
                <div class="card h-100 hover-shadow">
                    <img src="/<%= plant.img %>" class="card-img-top cropped-image" alt="...">
                    <div class="card-body">
                        <% if (plant.name) {%>
                            <h5 class="card-title"><%= plant.name %> Identification: Approved</h5>
                        <%} else {%>
                            <h5 class="card-title">Identification: In-progress</h5>
                        <% }%>
                        <p class="card-text"><%= plant.description %></p>
                        <br>
                        <button class="btn btn-primary">View Plant</button>
                    </div>
                    <div class="card-footer">
                        <% const date = new Date(Date.parse(plant.date)); %>
                        <small class="text-muted">Found at <%= plant.location + ", on " + date.toLocaleDateString('en-GB'); %></small>
                    </div>
                </div>
            </a>
        </div>
    <% }); %>
</div>


<script src="js/bootstrap.min.js"></script>
</body>
</html>

<script>
  function myFunction() {
    document.getElementById("myDropdown").classList.toggle("show");
  }

  // Close the dropdown menu if the user clicks outside of it
  window.onclick = function(event) {
    if (!event.target.matches('.dropbtn')) {
      var dropdowns = document.getElementsByClassName("dropdown-content");
      var i;
      for (i = 0; i < dropdowns.length; i++) {
        var openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  }
</script>